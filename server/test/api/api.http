### Get server
GET http://localhost:4000/api/server

### Get devices
GET http://localhost:4000/api/devices

### Get devices
GET http://localhost:4000/api/devices/1

### Get devices
GET http://localhost:4000/api/devices?id=1

### Get devices
GET http://localhost:4000/api/devices?id=1&id=2&id=3

### Get positions
GET http://localhost:4000/api/positions

### Get position
GET http://localhost:4000/api/positions?deviceId=4

### Get position
GET http://localhost:4000/api/positions?deviceId=1&deviceId=2&deviceId=3

### Add Devices
POST http://localhost:4000/api/devices
Content-Type: application/json

{
    "name": "uav_14",
    "category": "dji_M300",
    "protocol": "ros",
    "ip": "10.42.0.44",
    "camera":[
        {
            "type": "WebRTC",
            "source": "main"
        }
    ],
    "files":[
        {
            "type": "onboard_computer",
            "url": "sftp://one:1234@127.0.0.1:4021"
        }
    ]
}

### Add Devices
POST http://localhost:4000/api/devices
Content-Type: application/json

{
    "name": "uav_758",
    "category": "dji_M300",
    "ip": "10.42.0.44",
    "camera":[]
}

### delete a device
DELETE http://localhost:4000/api/devices/1

### update a device
PATCH http://localhost:4000/api/device/2
Content-Type: application/json

{
  "ip": "10.42.0.44"
}

### Get list of category
GET http://localhost:4000/api/category

### Get category info
GET http://localhost:4000/api/category/dji_M300

### Get message info
GET http://localhost:4000/api/category/messages/

### Atributes
GET http://localhost:4000/api/category/atributes/dji_M210_noetic

### Atributes
GET http://localhost:4000/api/category/atributesparam/dji_M210_noetic/mode_yaw

### Actions
GET http://localhost:4000/api/category/actions/dji_M210_noetic

### Commandos
GET http://localhost:4000/api/commands/send

### Commands types
GET http://localhost:4000/api/commands/types

### send command threat
POST http://localhost:4000/api/commands/send
Content-Type: application/json

{
    "deviceId": 5,
    "type": "threat"
}

### send command loadmission
POST http://localhost:4000/api/commands/send
Content-Type: application/json

< ./json/loadmission.json

### send command mission
POST http://localhost:4000/api/commands/send
Content-Type: application/json

{
    "deviceId": 5,
    "type": "commandMission"
}

### ============================================
### Mission API
### ============================================

### Sendtask - Centro2
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/task_Centro2.json

### Sendtask - GW tasks
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/gw-sendtasks.json

### Sendtask - GW tasks 2
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/gw-sendtasks2.json

### Sendtask - Prueba tramo largo drone (id 118)
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/sendtask_118.json

### Sendtask - Prueba tramo largo drone (id 119)
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/sendtask_119.json

### Sendtask - Alarma meteo apoyo
POST http://localhost:4000/api/missions/sendTask
Content-Type: application/json

< ./json/sendtask_alarma_meteo.json

### setMission
POST http://localhost:4000/api/missions/setMission
Content-Type: application/json

< ./json/mission.json

### variables
@uav_id = 3
@mission_id = 1

### get mission
GET  http://localhost:4000/api/missions

### get mission by id
GET  http://localhost:4000/api/missions?id=72510181

### get mission routes
GET  http://localhost:4000/api/missions/routes

### get mission route by missionId
GET  http://localhost:4000/api/missions/routes?missionId=72510181

### update files
GET  http://localhost:4000/api/missions/updateFiles/{{uav_id}}/{{mission_id}}

### list files
GET  http://localhost:4000/api/missions/listFiles/{{mission_id}}/{{uav_id}}

### ============================================
### Files API
### ============================================

### show files
GET  http://localhost:4000/api/files/showFiles/{{uav_id}}/{{mission_id}}

### updateFiles
GET  http://localhost:4000/api/files/updateFiles/{{uav_id}}/{{mission_id}}

### download files
GET http://localhost:4000/api/files/download/mission_1243/uav_15/DJI_20231124131954_0001_THRM.jpg

### download pcd file
GET http://localhost:4000/api/files/download/mission_72510181/uav_14/distances.pcd

### list files GCS
GET http://localhost:4000/api/files/get

### list files GCS by missionId
GET http://localhost:4000/api/files/get?missionId=72510181

### list files GCS by missionId 2
GET http://localhost:4000/api/files/get?missionId=57641431

### list files
GET http://localhost:4000/api/files/listFiles

### Get metadata
POST  http://localhost:4000/api/files/test
Content-Type: application/json

{
    "src":"/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240226142604_0003_THRM_process.jpg"
}

### get temp max of metadata
POST  http://localhost:4000/api/files/TempResult
Content-Type: application/json

{
    "src":[
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240223174110_0013_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240223174112_0014_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240223174116_0015_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240223174122_0016_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240226142604_0003_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240223174122_0016_THRM_process.jpg",
      "/home/grvc/work/GCS_media/mission_92254290/uav_14/DJI_20240305104808_0006_THRM_process.jpg"
    ]
}

### process images
POST  http://localhost:4000/api/files/ProcessImage
Content-Type: application/json

{
    "src":[
      "/home/grvc/work/px4/uav_media/test/10-08-14-488-radiometric.jpg",
      "/home/grvc/work/px4/uav_media/test/10-08-14-488-radiometric.tiff",
      "/home/grvc/work/px4/uav_media/test/DJI_20240305122546_0001_THRM.jpg"
    ]
}

### ============================================
### Planning API
### ============================================

### get planning mission
GET http://localhost:4000/api/planning/mission

### get planning missions type
GET http://localhost:4000/api/planning/missionstype

### get planning mission param
GET http://localhost:4000/api/planning/missionparam/0

### get markers types
GET http://localhost:4000/api/planning/getMarkersTypes

### get markers
GET http://localhost:4000/api/planning/getMarkers

### get bases
GET http://localhost:4000/api/planning/getBases

### ============================================
### ROS API
### ============================================

### get topics
GET http://localhost:4000/api/ros/topics

### get services
GET http://localhost:4000/api/ros/services

### get service type
GET http://localhost:4000/api/ros/service_type?service=/px4_3/land

### get service type - mission load
GET http://localhost:4000/api/ros/service_type?service=/px4_3/offboard/mission_load

### check service request structure - Trigger
GET http://localhost:4000/api/ros/service_request_details?type=std_srvs/srv/Trigger

### check service request structure - LoadMission
GET http://localhost:4000/api/ros/service_request_details?type=muav_gcs_interfaces/srv/LoadMission

### call service - land
POST http://localhost:4000/api/ros/service_call
Content-Type: application/json

{
  "service": "/px4_3/land",
  "messageType": "std_srvs/srv/Trigger",
  "message": {}
}

### call service - takeoff
POST http://localhost:4000/api/ros/service_call
Content-Type: application/json

{
  "service": "/px4_3/takeoff",
  "messageType": "px4_msgs/srv/VehicleCommand",
  "message": {
    "request": {
      "timestamp":0,
      "param1":1,
      "param2":2,
      "param3":3,
      "param4":4,
      "param5":5,
      "param6":6,
      "param7":7,
      "source_system":1,
      "source_component":1,
      "target_system":1,
      "target_component":1,
      "command": 22,
      "confirmation":0,
      "from_external":true
     }
   }
}

### get topic type
GET http://localhost:4000/api/ros/topics_type?topic=/px4_3/fmu/out/vehicle_local_position

### get message details
GET http://localhost:4000/api/ros/message_details?type=px4_msgs/msg/VehicleLocalPosition

### get message details - Twist
GET http://localhost:4000/api/ros/message_details?type=geometry_msgs/msg/Twist

### get message details - Twist1 (error case)
GET http://localhost:4000/api/ros/message_details?type=geometry_msgs/msg/Twist1

### get publisher
GET http://localhost:4000/api/ros/publisher?topic=/px4_3/fmu/out/vehicle_local_position

### subscribe once - vehicle local position
GET http://localhost:4000/api/ros/subscribe_once?topic=/px4_3/fmu/out/vehicle_local_position

### subscribe once - bcr_bot odom
GET http://localhost:4000/api/ros/subscribe_once?topic=/bcr_bot/odom

### subscribe once - turtlebot pose
GET http://localhost:4000/api/ros/subscribe_once?topic=/turtle1/pose

### get action servers
GET http://localhost:4000/api/ros/action_servers

### send action goal - navigate_to_pose
POST http://localhost:4000/api/ros/action_send_goal
Content-Type: application/json

< ./json/action_navigate_to_pose.json

### cancel action goal - navigate_to_pose
POST http://localhost:4000/api/ros/action_cancel_goal
Content-Type: application/json

{
  "action": "navigate_to_pose"
}

### publish - trajectory setpoint
POST http://localhost:4000/api/ros/publish
Content-Type: application/json

< ./json/publish_trajectory_setpoint.json

### publish - goto setpoint
POST http://localhost:4000/api/ros/publish
Content-Type: application/json

< ./json/publish_goto_setpoint.json

### publish - bcr_bot goal pose
POST http://localhost:4000/api/ros/publish
Content-Type: application/json

< ./json/publish_bcr_bot_goal.json

### publish - goal pose
POST http://localhost:4000/api/ros/publish
Content-Type: application/json

< ./json/publish_goal_pose.json

### publish - turtle cmd_vel
POST http://localhost:4000/api/ros/publish
Content-Type: application/json

{
  "topic": "/turtle1/cmd_vel",
  "messageType": "geometry_msgs/msg/Twist",
  "message": {
    "linear": { "x": 1.0, "y": 0.0, "z": 0.0 },
    "angular": { "x": 0.0, "y": 0.0, "z": 0.0 }
  }
}

### ============================================
### Map API
### ============================================

### Elevation - query string
GET http://localhost:4000/api/map/elevation?locations=[[44.074221911574284,11.221895356523419]]

### Elevation - external API
GET https://api.opentopodata.org/v1/eudem25m?locations=37.410266,-6.002490|37.410572,-6.002949|37.411010,-6.003243

### Elevation - POST with route
POST http://localhost:4000/api/map/elevation
Content-Type: application/json

< ./json/elevationRoute.json

### ============================================
### Images/Media API
### ============================================

### placeholder image
GET http://localhost:4000/api/placeholder

### Image ros
GET http://localhost:4000/api/media/:deviceid

### Image Ros
GET http://localhost:4000/api/media1/:deviceid

### ============================================
### Server API
### ============================================

### datetime
GET http://localhost:4000/api/server/datetime

### server config
GET http://localhost:4000/api/server

### ============================================
### External Application API
### ============================================

### update token
GET http://localhost:4000/api/ExtApp/updateToken

### start mission
POST  http://localhost:4000/api/ExtApp/start
Content-Type: application/json

< ./json/missionresponse.json

### result
POST  http://localhost:4000/api/ExtApp/result
Content-Type: application/json

{
  "mission_id": 1234231,
  "resolution_code": 0
}

### media
POST  http://localhost:4000/api/ExtApp/media
Content-Type: application/json

< ./json/extapp_media.json

### ============================================
### Events API
### ============================================

### SSE events
GET http://localhost:4000/api/events HTTP/1.1

### ============================================
### External Services
### ============================================

### external input test
POST http://192.168.1.180:8004/input_test
Content-Type: application/json

{
    "deviceId": 5,
    "type": "threat"
}

### get plan from external
GET http://192.168.1.180:8004/get_plan?IDs=1234

### missions test
GET  http://localhost:4000/api/missions/test

### get plan local
GET http://127.0.0.1:8004/get_plan?IDs=76327900

### mission request 1
POST http://127.0.0.1:8004/mission_request
Content-Type: application/json

< ./json/missionRequest1.json

### mission request 2
POST http://127.0.0.1:8004/mission_request
Content-Type: application/json

< ./json/missionRequest2.json

### ============================================
### Chat API - server/routes/chat.js
### ============================================

### chat simple
POST http://localhost:4000/api/chat
Content-Type: application/json

{
  "provider": "gemini",
  "message":"cual es la capital de españa?"
}

### chat - drones conectados
POST http://localhost:4000/api/chat
Content-Type: application/json

{
  "message": "Hola, ¿cuántos drones hay conectados?"
}

### chat con chatId
POST http://localhost:4000/api/chat
Content-Type: application/json

{
  "message": "Dame el estado de todos los dispositivos",
  "chatId": "mission-planning-001"
}

### Error: mensaje vacío (espera 400)
POST http://localhost:4000/api/chat
Content-Type: application/json

{
  "message": ""
}

### Error: sin campo message (espera 400)
POST http://localhost:4000/api/chat
Content-Type: application/json

{
  "chatId": "test-chat"
}

### listar todos los chats
GET http://localhost:4000/api/chat/chats

### historial de chat - default
GET http://localhost:4000/api/chat/history/default_http

### historial de chat - personalizado
GET http://localhost:4000/api/chat/history/mission-planning-001

### historial chat inexistente
GET http://localhost:4000/api/chat/history/chat-inexistente-xyz

### renombrar chat - default
PATCH http://localhost:4000/api/chat/chats/default_http
Content-Type: application/json

{
  "name": "Chat Principal"
}

### renombrar chat - personalizado
PATCH http://localhost:4000/api/chat/chats/mission-planning-001
Content-Type: application/json

{
  "name": "Planificación Misión Norte"
}

### Error: sin nombre (espera 400)
PATCH http://localhost:4000/api/chat/chats/default_http
Content-Type: application/json

{
}

### Error: nombre vacío (espera 400)
PATCH http://localhost:4000/api/chat/chats/default_http
Content-Type: application/json

{
  "name": ""
}

### Soft delete chat
DELETE http://localhost:4000/api/chat/chats/chat-temporal

### Hard delete chat
DELETE http://localhost:4000/api/chat/chats/chat-temporal?hard=true

### ============================================
### Mission Planning Chat API
### ============================================

### build mission plan XYZ
POST  http://localhost:4000/api/chat/build_mission_plan_xyz
Content-Type: application/json

< ./json/build_mission_plan_xyz.json

### validate mission briefing
POST  http://localhost:4000/api/chat/validate_mission_briefing
Content-Type: application/json

< ./json/validate_mission_briefing.json

### ============================================
### Collision Detection API - server/models/collision
### ============================================

### validate mission with collisions
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/collision_validate.json

### validate mission - safe (no collisions)
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/collision_validate_safe.json

### validate mission with collisions
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/collision_detail.json

### resolve collisions automatically
POST http://localhost:4000/api/missions/resolve
Content-Type: application/json

< ./json/collision_resolve.json

### resolve with multiple obstacles
POST http://localhost:4000/api/missions/resolve
Content-Type: application/json

< ./json/collision_resolve_multi.json

### Error case: missing mission
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

{
  "obstacles": []
}

### Error case: missing obstacles
POST http://localhost:4000/api/missions/resolve
Content-Type: application/json

{
  "mission": {
    "route": []
  }
}

### ============================================
### MCP Client Collision Validation Tests
### ============================================

### MCP validate collision - with collisions expected
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/mcp_validate_collision.json

### MCP validate collision - safe route (no collisions)
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/mcp_validate_collision_safe.json

### MCP validate collision - multi-route mission
POST http://localhost:4000/api/missions/validate
Content-Type: application/json

< ./json/mcp_validate_collision_multi_route.json


# test agent planner chat
POST http://localhost:4000/api/chat/subagent_planner_chat
Content-Type: application/json

< ./json/subagent_planner_chat_standar.json

###

### build mission plan XYZ
POST  http://localhost:4000/api/chat/build_mission_plan_xyz
Content-Type: application/json

< ./json/subagent_planner_chat_fast_AB.json
